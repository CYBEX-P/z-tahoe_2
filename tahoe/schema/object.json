{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "object_core",
  "description" : "Validate core structure of an object.",
  "required": ["itype", "uuid", "obj_type", "attributes"],
  "properties": {
    "itype": {"const" : "object"},
    "uuid": { "type": "string", "pattern" : "^object--[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[89abAB][0-9a-fA-F]{3}\\-[0-9a-fA-F]{12}$" },
	"obj_type": { "enum" : ["attacker",
							"autonomous_system",
							"bank_ac",
							"check",
							"campaign",
							"code_script",
							"comp_algo_set",
							"credential",
							"credit_card",
							"cryptocurrency_addr",
							"cti_analysis",
							"data",
							"datetime",
							"domain",
							"dst",
							"email",
							"encr_algo_set",
							"file",
							"flight",
							"financial_institute",
							"geoip",
							"github",
							"hash",
							"host",
							"http",
							"identity",
							"info",
							"jabber",
							"kex_algo_set",
							"link",
							"mac_address",
							"mac_algo_set",
							"malware",
							"mobile_app",
							"ms_pdb",
							"organization",
							"other",
							"passenger",
							"passport",
							"payment",
							"person",
							"size",
							"software",
							"src",
							"ssl_client",
							"ssh_server",
							"target",
							"text",
							"threat_actor",
							"twitter_ac",
							"uri",
							"url",
							"visa",
							"vulnerability",
							"web_content",
							"whois",
							"win_registry",
							"win_sys",
							"x_misp",
							"x509"]},
	"attributes": { "type" : "array"},
	"_ref" : { "type" : "array", "items" : { "type": "string", "pattern" : "^(attribute|event|session|raw)--[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[89abAB][0-9a-fA-F]{3}\\-[0-9a-fA-F]{12}$"} }
  },
  "additionalProperties": false
}
